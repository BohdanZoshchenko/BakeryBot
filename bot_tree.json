{
    "description" : "Bot JSON chat tree",
    "for_customer" : "Mari_Ko Bakery Club",

    "database" : 
    {
        "create_tables" :
        [
            "CREATE TABLE IF NOT EXISTS admin (user_id integer NOT NULL)",

            "CREATE TABLE IF NOT EXISTS promotion (name varchar NOT NULL, text varchar NOT NULL, photo bytea[] NULL)",
            
            "CREATE TABLE IF NOT EXISTS client (chat_id integer NOT NULL, level varchar NULL, funnel varchar NULL, params varchar[] NULL, PRIMARY KEY (chat_id))",
    
            "CREATE TABLE IF NOT EXISTS client_data (chat_id integer NULL, datetime varchar NULL, phone varchar NULL, name varchar NULL, order_desc varchar NULL, price integer NULL, PRIMARY KEY (chat_id))",

            "CREATE TABLE IF NOT EXISTS item (name varchar(45) NOT NULL, description varchar(450) NOT NULL, photo bytea NOT NULL, category varchar NULL, price integer NOT NULL DEFAULT '450')",
            
            "CREATE TABLE IF NOT EXISTS client_order (client_id integer NOT NULL, description varchar NOT NULL, price float NOT NULL, sent boolean DEFAULT FALSE)"
        ],

        "set_user_state" : "INSERT INTO client VALUES(%s,%s,%s,%s) ON CONFLICT (chat_id) DO UPDATE SET level = %s, funnel = %s, params = %s",
        "get_user_state" : "SELECT level, funnel, params FROM client WHERE chat_id = %s",
        "get_admins" : "SELECT * FROM admin"
    },

    "params":
    {
        "telegram_token" : "1793479610:AAFJBhZAGwlVbddGk-qt4dGHvEnpDn3R5C0",
        "admin_password" : "_VpuVq`8tZy&M9_2",

        "server_port" : 33507,
        "url" : "https://bakerybotmariko.herokuapp.com/",

        "database" :
        {
            "development" :
            {
                "host" : "localhost",
                "database" : "python_test", 
                "user" : "objectrocket",
                "port" : 5432,
                "password" : "mypass"
            },

            "production" :
            {
                "host" : "ec2-34-252-251-16.eu-west-1.compute.amazonaws.com",
                "database" : "dck5ab2bh2maq8", 
                "user" : "eimhjqlhsuvtpu",
                "port" : 5432,
                "password" : "3f28e44affc43038dd7ae342e5ba10427858ba580addc4d448bcf7f4238bc772"
            }
        },
        
        "instagram_link" : "https://www.instagram.com/mari_ko_bakeryclub/",
        "instagram_login_credentials" : 
        {
            "login" : "",
            "password" : ""
        }
    },
    "admin" :
    {
        "start" : 
        {

        }
    },

    "user" :
    {
        "unknown_input" : 
        {
            "text" : "–Ø –≤–∞—Å –Ω–µ —Ä–æ–∑—É–º—ñ—éüòï –°–ø—Ä–æ–±—É–π—Ç–µ —è–∫–æ—Å—å —ñ–Ω–∞–∫—à–µ.",
            "inline_buttons" : [[["–°–ø—Ä–æ–±—É–≤–∞—Ç–∏", "new_greeting"]]]
        },

        "funnel_unknown_input" : "–°—Ç–∞–ª–∞—Å—å —è–∫–∞—Å—å –ø–æ–º–∏–ª–∫–∞üòï –î–∞–≤–∞–π—Ç–µ —Å–ø—Ä–æ–±—É—î–º–æ —â–µ",

        "recent_post_title" : "üì∞–°–≤—ñ–∂–∞ –Ω–æ–≤–∏–Ω–∞üì∞\nüÜï–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —Ü–µ–π —Ç–µ–∫—Å—ÇüÜï",
        "on_user_distracted" : "–©–æ—Å—å –º–∏ –≤—ñ–¥–≤–æ–ª—ñ–∫–ª–∏—Å—è üòÖ",

        "simple_gotos" :
        {
            "start" :
            {
                "text" : "–ü—Ä–∏–≤—ñ—Ç üëãüòä, —è –±–æ—Ç ü§ñ –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å—å–∫–æ—ó üç∞üéÇüßÅ Mari_Ko Bakery Club üï∂Ô∏è! –ß–æ–≥–æ –±–∞–∂–∞—î—Ç–µ üßû?",
                "inline_buttons" : 
                [
                    [ ["–ó–∞–º–æ–≤–∏—Ç–∏ —Å–º–∞–∫–æ–ª–∏–∫–∏", "order"] ],
                    [ ["–Ü–Ω—Ñ–æ", "info_in_telegram"] ]
                ]
            }
        },
        
        "commands" :
        {
            "start" : 
            {
                "goto" : "start"
            },
            "help" : 
            {
                "goto" : "start"
            }
        },
        
        "simple_buttons" :
        [
            [ ["–ü–æ—á–∞—Ç–∏", "start" ] ]
        ],
        
        "simple_callbacks" :
        {
            "info_in_messenger" :
            {

            },

            "info_in_telegram" :
            {
                "text" : "–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è:\n–¢–æ—Ä—Ç/—á–∏–∑–∫–µ–π–∫ - 6-7 –¥–Ω—ñ–≤\n–ö–∞–ø–∫–µ–π–∫–∏ - 4-5 –¥–Ω—ñ–≤\n–ë—Ä–æ–Ω—é–≤–∞–Ω–Ω—è –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è –ø—ñ—Å–ª—è —É—Ç–æ—á–Ω–µ–Ω–Ω—è:\n-–¥–∞—Ç–∏ —Ç–∞ —á–∞—Å—É\n-–≤–∞–≥–∏ —Ç–∞ –Ω–∞—á–∏–Ω–∫–∏\n-–¥–µ–∫–æ—Ä—É\n-–ø–µ—Ä–µ–¥–æ–ø–ª–∞—Ç–∏ 50 –≤—ñ–¥—Å–æ—Ç–∫—ñ–≤ –≤—ñ–¥ –≤–∞—Ä—Ç–æ—Å—Ç—ñ –≤–∏—Ä–æ–±—É\n–î–ï–ö–û–† –û–ü–õ–ê–ß–£–Ñ–¢–¨–°–Ø –û–ö–†–ï–ú–û\n–î–û–°–¢–ê–í–ö–ê - –°–ê–ú–û–í–ò–í–Ü–ó/ –¢–ê–ö–°–Ü\n–ó –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –ø–∏—Ç–∞–Ω—å –ø–∏—à—ñ—Ç—å –∫–æ–Ω–¥–∏—Ç–µ—Ä—Ü—ñ –ú–∞—Ä—ñ—ó @MariaYav –∞–±–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É–π—Ç–µ —ó–π +380 63 763 21 33",
                "inline_buttons":[[["–ù–∞–∑–∞–¥", "new_greeting"]]]
            },

            "order" :
            {
                "description" : "Create buttons from DB items entries",
                "func" : "show_categories"
            },

            "new_greeting" :
            {
                "text" : "–•–æ—á–µ—Ç–µ —Å–º–∞–∫–æ–ª–∏–∫—ñ–≤ üßû?",
                "inline_buttons" : 
                [
                    [ ["–ó–∞–º–æ–≤–∏—Ç–∏ —Å–º–∞–∫–æ–ª–∏–∫–∏", "order"] ],
                    [ ["–Ü–Ω—Ñ–æ", "info_in_telegram"] ]
                ]
            },

            "cancel_orders":
            {
                "func" : "cancel_orders"
            }
        },
        
        "composite_callbacks" :
        {
            "show_items" :
            {
                "func" : "show_items"
            },
            "show_item" : 
            {
                "sql" : "SELECT name, description, photo, price, category FROM item WHERE name=%s",
                "func" : "show_single_item"
            },
            "order" :
            {
                "funnel" : "order_item"
            }
        },
        "funnels" :
        {
            "order_info" :
            {
                "0" : 
                {
                    "func" : "form_order"
                }, 
                "1" : 
                {
                    "input_type" : "text",
                    "text" : "–¢–µ–ø–µ—Ä *–û–ë–û–í'–Ø–ó–ö–û–í–û* –¥–∞–π—Ç–µ —Å–≤—ñ–π –Ω–æ–º–µ—Ä –¥–ª—è –∑–≤'—è–∑–∫—É",
                    "func" : "save_date"
                },
                "2" :
                {
                    "input_type" : "text",
                    "text" : "–ù–∞–æ—Å—Ç–∞–Ω–æ–∫, —è–∫ –≤–∞—Å –∑–≤—É—Ç—å? *–û–ë–û–í'–Ø–ó–ö–û–í–û* –Ω–∞–ø–∏—à—ñ—Ç—å",
                    "func" : "save_phone"
                },
                "3" :
                {
                    "input_type" : "text",
                    "func" : "finish_order"
                }
            },

            "–¢–æ—Ä—Ç–∏" :
            {
                "0" :
                {
                    "func" : "order_item_start"
                },
                "1" : 
                {
                    "sql" : "SELECT price, category FROM item WHERE name=%s",
                    "func" : "order_item_mass",

                    "errors":
                    {
                        "too_little" : "–ó–∞–º–∞–ª–∞ –≤–∞–≥–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ",
                        "too_big" : "–î—É–∂–µ –≤–µ–ª–∏–∫–∞ –≤–∞–≥–∞. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ",
                        "type_mismatch" : "–Ø –±–æ—Ç, —Ç–æ–º—É –∑—Ä–æ–∑—É–º—ñ—é —Ç—ñ–ª—å–∫–∏ —á–∏—Å–ª–æ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, 2.5"
                    },
                    
                    "input_type" : "float",
                    "min" : 2,
                    "max" : 102,
                    "after_comma" : 2
                }
            },
            "–ö–∞–ø–∫–µ–π–∫–∏" :
            {
                "0" :
                {
                    "func" : "order_item_start"
                },
                "1" : 
                {
                    "sql" : "SELECT price, category FROM item WHERE name=%s",
                    "func" : "order_item_mass",

                    "errors":
                    {
                        "too_little" : "–ó–∞–º–∞–ª–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ",
                        "too_big" : "–î—É–∂–µ –≤–µ–ª–∏–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ",
                        "type_mismatch" : "–Ø –º–æ–∂—É –ø—Ä–∏–π–Ω—è—Ç–∏ —Ç—ñ–ª—å–∫–∏ —Ü—ñ–ª–µ —á–∏—Å–ª–æ. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, 10"
                    },
                    
                    "input_type" : "int",
                    "min" : 6,
                    "max" : 106
                }
            }
        }
    }
}